{% extends "base.html" %}

{% block title %}–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è - Alien Tutor{% endblock %}

{% block styles %}
<style>
    /* ===== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –°–¢–ò–õ–ò –î–õ–Ø –õ–ö–† ===== */
    
    /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –¥–µ—Ç–µ–π (–¥–ª—è —Å–µ–º–µ–π) */
    .children-switcher {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 20px;
        padding: 15px;
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
    }

    .theme-dark .children-switcher {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(217, 246, 244, 0.15);
    }

    .theme-light .children-switcher {
        background: rgba(255, 255, 255, 0.3);
        border: 1px solid rgba(44, 62, 80, 0.1);
    }

    .children-label {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-accent, #5ED9D7);
        margin-right: 10px;
    }

    .children-toggle-group {
        display: flex;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 12px;
        padding: 4px;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .child-toggle-btn {
        background: transparent;
        border: none;
        padding: 10px 20px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        color: inherit;
        opacity: 0.7;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .child-toggle-btn.active {
        background: linear-gradient(135deg, rgba(94, 217, 215, 0.3) 0%, rgba(94, 217, 215, 0.5) 100%);
        color: inherit;
        opacity: 1;
        box-shadow: 0 4px 15px rgba(94, 217, 215, 0.3);
    }

    .theme-dark .child-toggle-btn.active {
        color: #D9F6F4;
        text-shadow: 0 0 10px rgba(94, 217, 215, 0.6);
    }

    .child-toggle-btn:not(.active):hover {
        opacity: 1;
        background: rgba(255, 255, 255, 0.1);
    }

    /* –¶–≤–µ—Ç–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π */
    .child-toggle-btn::before {
        content: '';
        position: absolute;
        bottom: 2px;
        left: 50%;
        transform: translateX(-50%);
        width: 30px;
        height: 3px;
        border-radius: 2px;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .child-toggle-btn.active::before {
        opacity: 1;
    }

    .child-toggle-btn[data-child="0"]::before {
        background: #00d4ff;
    }

    .child-toggle-btn[data-child="1"]::before {
        background: #a855f7;
    }

    .child-toggle-btn[data-child="2"]::before {
        background: #10b981;
    }

    /* –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */
    .financial-section {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        padding: 2rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
    }

    .theme-dark .financial-section {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(217, 246, 244, 0.15);
    }

    .theme-light .financial-section {
        background: rgba(255, 255, 255, 0.3);
        border: 1px solid rgba(44, 62, 80, 0.1);
    }

    .financial-section::before {
        content: 'üí∞';
        position: absolute;
        top: 20px;
        right: 20px;
        font-size: 2rem;
        opacity: 0.3;
    }

    .financial-title {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        color: var(--text-accent, #5ED9D7);
    }

    .financial-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
    }

    .financial-card {
        background: rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 12px;
        padding: 1.5rem;
        text-align: center;
        transition: all 0.3s ease;
    }

    .theme-dark .financial-card {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(217, 246, 244, 0.2);
    }

    .theme-light .financial-card {
        background: rgba(255, 255, 255, 0.4);
        border: 1px solid rgba(44, 62, 80, 0.15);
    }

    .financial-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        border-color: rgba(94, 217, 215, 0.5);
    }

    .financial-value {
        font-size: 2rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
        color: var(--text-accent, #5ED9D7);
        text-shadow: 0 0 15px rgba(94, 217, 215, 0.3);
    }

    .financial-label {
        font-size: 0.9rem;
        opacity: 0.9;
        font-weight: 500;
        color: inherit;
    }

    /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ */
    .financial-card.debt {
        background: rgba(239, 68, 68, 0.1);
        border: 2px solid rgba(239, 68, 68, 0.4);
    }

    .financial-card.debt .financial-value {
        color: #ef4444;
    }

    /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∑–∞–ø–∞—Å–∞ */
    .financial-card.stock {
        background: rgba(16, 185, 129, 0.1);
        border: 2px solid rgba(16, 185, 129, 0.4);
    }

    .financial-card.stock .financial-value {
        color: #10b981;
    }

    /* –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∏–ª–µ–π –¥–ª—è –õ–ö–† */
    .parent-dashboard-header {
        text-align: center;
        margin-bottom: 2rem;
        position: relative;
    }

    .parent-dashboard-header h1 {
        font-size: 2.5rem;
        margin-bottom: 0.5rem;
    }

    .parent-info {
        font-size: 1.1rem;
        opacity: 0.8;
        margin-bottom: 0;
    }

    /* –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –õ–ö–£, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –Ω—É–∂–Ω—ã –≤ –õ–ö–† */
    .futuristic-panel,
    .action-card,
    #game-tab {
        display: none !important;
    }

    /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –≤–∫–ª–∞–¥–∫–∞–º –¥–ª—è –õ–ö–† */
    .parent-tabs-navigation {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
    }

    /* –í–∏–¥–∂–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (–≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π) */
    .schedule-widget-container {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        padding: 2rem;
        margin-bottom: 2rem;
        min-height: 400px;
        position: relative;
    }

    .theme-dark .schedule-widget-container {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(217, 246, 244, 0.15);
    }

    .theme-light .schedule-widget-container {
        background: rgba(255, 255, 255, 0.3);
        border: 1px solid rgba(44, 62, 80, 0.1);
    }

    .widget-loading {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 300px;
        color: var(--text-muted, rgba(217, 246, 244, 0.8));
    }

    .widget-loading-spinner {
        width: 50px;
        height: 50px;
        border: 3px solid rgba(94, 217, 215, 0.2);
        border-top: 3px solid #5ED9D7;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 1rem;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
</style>
{% endblock %}
{% block content %}
    <div class="dashboard-container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
        <div class="parent-dashboard-header">
            <h1>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è</h1>
            <p class="parent-info">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á</p>
        </div>

        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –¥–µ—Ç–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ–º–µ–π —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –¥–µ—Ç—å–º–∏) -->
        <div class="children-switcher" id="childrenSwitcher" style="display: none;">
            <span class="children-label">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–±–µ–Ω–∫–∞:</span>
            <div class="children-toggle-group">
                <button class="child-toggle-btn active" data-child="0" onclick="switchChild(0)">
                    –ú–∞—Ä–∏—è
                </button>
                <button class="child-toggle-btn" data-child="1" onclick="switchChild(1)">
                    –ê–ª–µ–∫—Å–∞–Ω–¥—Ä
                </button>
                <button class="child-toggle-btn" data-child="2" onclick="switchChild(2)">
                    –ï–ª–∏–∑–∞–≤–µ—Ç–∞
                </button>
            </div>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º -->
        <div class="tabs-navigation parent-tabs-navigation">
            <button class="tab-button active" data-tab="main">
                <span class="tab-text">–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="tab-button" data-tab="progress">
                <span class="tab-text">–£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å</span>
            </button>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
        <div class="tabs-content">

            <!-- –í–∫–ª–∞–¥–∫–∞: –ì–ª–∞–≤–Ω–∞—è (–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ + –§–∏–Ω–∞–Ω—Å—ã) -->
            <div class="tab-content active" id="main-tab">
                
                <!-- –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                <div class="financial-section">
                    <h2 class="financial-title">–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                    <div class="financial-grid">
                        <div class="financial-card">
                            <div class="financial-value">12</div>
                            <div class="financial-label">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ —É—Ä–æ–∫–æ–≤</div>
                        </div>
                        <div class="financial-card stock">
                            <div class="financial-value">5</div>
                            <div class="financial-label">–ó–∞–ø–∞—Å —É—Ä–æ–∫–æ–≤</div>
                        </div>
                        <div class="financial-card debt">
                            <div class="financial-value">2</div>
                            <div class="financial-label">–û–∂–∏–¥–∞—é—Ç –æ–ø–ª–∞—Ç—ã</div>
                        </div>
                        <div class="financial-card">
                            <div class="financial-value">1500‚ÇΩ</div>
                            <div class="financial-label">–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Ä–æ–∫–∞</div>
                        </div>
                        <div class="financial-card">
                            <div class="financial-value">25</div>
                            <div class="financial-label">–ü—Ä–æ–≤–µ–¥–µ–Ω–æ —É—Ä–æ–∫–æ–≤</div>
                        </div>
                        <div class="financial-card">
                            <div class="financial-value">3</div>
                            <div class="financial-label">–û—Ç–º–µ–Ω–µ–Ω–æ —É—Ä–æ–∫–æ–≤</div>
                        </div>
                    </div>
                </div>

                <!-- –í–∏–¥–∂–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è -->
                <div class="schedule-widget-container">
                    <h2 style="text-align: center; margin-bottom: 1.5rem; color: var(--text-accent, #5ED9D7);">
                        –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π
                    </h2>
                    
                    <!-- –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –≤–∏–¥–∂–µ—Ç–∞ -->
                    <div class="widget-loading">
                        <div class="widget-loading-spinner"></div>
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è...</p>
                        <p style="font-size: 0.9rem; opacity: 0.7; margin-top: 1rem;">
                            –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤–∏–¥–∂–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
                        </p>
                    </div>
                    
                    <!-- –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ -->
                    <div class="schedule-demo" style="display: none;">
                        <div class="schedule-container">
                            <div class="schedule-controls">
                                <button class="nav-btn">‚Üê –ù–∞–∑–∞–¥</button>
                                <div class="schedule-info">
                                    <span class="current-period">–ù–µ–¥–µ–ª—è 6, 2025</span>
                                </div>
                                <button class="nav-btn">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
                            </div>
                            
                            <div class="schedule-grid" style="margin-top: 2rem;">
                                <div class="day-column">
                                    <div class="day-header">
                                        <div class="day-name">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</div>
                                        <div class="day-date">10</div>
                                    </div>
                                    <div class="lessons-list">
                                        <div class="lesson-placeholder">–ù–µ—Ç –∑–∞–Ω—è—Ç–∏–π</div>
                                    </div>
                                </div>
                                
                                <div class="day-column">
                                    <div class="day-header">
                                        <div class="day-name">–í—Ç–æ—Ä–Ω–∏–∫</div>
                                        <div class="day-date">11</div>
                                    </div>
                                    <div class="lessons-list">
                                        <div class="lesson-item-placeholder">
                                            <div class="lesson-time">15:00</div>
                                            <div class="lesson-subject">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ - –ú–∞—Ä–∏—è</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="day-column today">
                                    <div class="day-header">
                                        <div class="day-name">–°—Ä–µ–¥–∞</div>
                                        <div class="day-date">12</div>
                                        <div class="today-badge">–°–µ–≥–æ–¥–Ω—è</div>
                                    </div>
                                    <div class="lessons-list">
                                        <div class="lesson-item-placeholder">
                                            <div class="lesson-time">16:00</div>
                                            <div class="lesson-subject">–§–∏–∑–∏–∫–∞ - –ê–ª–µ–∫—Å–∞–Ω–¥—Ä</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="day-column">
                                    <div class="day-header">
                                        <div class="day-name">–ß–µ—Ç–≤–µ—Ä–≥</div>
                                        <div class="day-date">13</div>
                                    </div>
                                    <div class="lessons-list">
                                        <div class="lesson-placeholder">–ù–µ—Ç –∑–∞–Ω—è—Ç–∏–π</div>
                                    </div>
                                </div>
                                
                                <div class="day-column">
                                    <div class="day-header">
                                        <div class="day-name">–ü—è—Ç–Ω–∏—Ü–∞</div>
                                        <div class="day-date">14</div>
                                    </div>
                                    <div class="lessons-list">
                                        <div class="lesson-item-placeholder">
                                            <div class="lesson-time">14:30</div>
                                            <div class="lesson-subject">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ - –ï–ª–∏–∑–∞–≤–µ—Ç–∞</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="day-column">
                                    <div class="day-header">
                                        <div class="day-name">–°—É–±–±–æ—Ç–∞</div>
                                        <div class="day-date">15</div>
                                    </div>
                                    <div class="lessons-list">
                                        <div class="lesson-placeholder">–ù–µ—Ç –∑–∞–Ω—è—Ç–∏–π</div>
                                    </div>
                                </div>
                                
                                <div class="day-column">
                                    <div class="day-header">
                                        <div class="day-name">–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ</div>
                                        <div class="day-date">16</div>
                                    </div>
                                    <div class="lessons-list">
                                        <div class="lesson-placeholder">–ù–µ—Ç –∑–∞–Ω—è—Ç–∏–π</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
<!-- –í–∫–ª–∞–¥–∫–∞: –£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å -->
            <div class="tab-content" id="progress-tab">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ -->
                <div class="child-progress-content" id="childProgress">
                    
                    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∏–º–µ–Ω–µ–º —Ä–µ–±–µ–Ω–∫–∞ -->
                    <div class="content-section" style="text-align: center; margin-bottom: 2rem;">
                        <h2>–£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å: <span id="currentChildName">–ú–∞—Ä–∏—è</span></h2>
                        <p style="opacity: 0.8;">9 –∫–ª–∞—Å—Å</p>
                    </div>

                    <!-- –î–∏–∞–≥—Ä–∞–º–º—ã (–∫–æ–ø–∏—è –∏–∑ –õ–ö–£, –Ω–æ –±–µ–∑ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–∞–º–∏) -->
                    <div class="charts-container">
                        <!-- –°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ -->
                        <div class="chart-section bar-chart-section">
                            <h3>–ë–∞–ª–ª—ã –∑–∞ –ø—Ä–æ–±–Ω–∏–∫–∏ –û–ì–≠</h3>
                            <div class="chart-wrapper">
                                <div class="bar-chart" id="parentBarChart">
                                    <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
                                </div>
                            </div>
                        </div>

                        <!-- –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ -->
                        <div class="chart-section pie-chart-section">
                            <h3>–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ–º</h3>
                            <div class="chart-wrapper">
                                <div class="pie-chart" id="parentPieChart">
                                    <svg viewBox="0 0 200 200" width="200" height="200">
                                        <!-- –ö—Ä—É–≥ –±—É–¥–µ—Ç –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω JavaScript -->
                                    </svg>
                                    <div class="pie-legend">
                                        <div class="legend-item">
                                            <span class="legend-color" style="background: #5ED9D7;"></span>
                                            <span>–¢–µ–º–∞ —Ä–∞–∑–æ–±—Ä–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-color" style="background: #f472b6;"></span>
                                            <span>–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ–º–µ</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-color" style="background: #60a5fa;"></span>
                                            <span>–¢–µ–º—É –Ω—É–∂–Ω–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- –¢–∞–±–ª–∏—Ü–∞ —É—Ä–æ–∫–æ–≤ -->
                    <div class="lessons-table-section">
                        <h3>–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã—Ö —É—Ä–æ–∫–æ–≤</h3>
                        <div class="table-wrapper">
                            <table class="lessons-table">
                                <thead>
                                    <tr>
                                        <th>–î–∞—Ç–∞ —É—Ä–æ–∫–∞</th>
                                        <th>–ü—Ä–æ–π–¥–µ–Ω–Ω–∞—è —Ç–µ–º–∞</th>
                                        <th>–ö—Ä–∞—Ç–∫–∏–π –≤—ã–≤–æ–¥</th>
                                        <th class="score-column">–ë–∞–ª–ª—ã –∑–∞ –ø—Ä–æ–±–Ω–∏–∫</th>
                                        <th>–†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –≤—ã–≤–æ–¥ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è</th>
                                        <th>–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ</th>
                                    </tr>
                                </thead>
                                <tbody id="parentLessonsTableBody">
                                    <!-- –î–∞–Ω–Ω—ã–µ –¥–ª—è –ú–∞—Ä–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
                                    <tr>
                                        <td>05.02.2025</td>
                                        <td>–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è</td>
                                        <td>–¢–µ–º–∞ —Ä–∞–∑–æ–±—Ä–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é</td>
                                        <td class="score-cell">85</td>
                                        <td>–ú–∞—Ä–∏—è –æ—Ç–ª–∏—á–Ω–æ —É—Å–≤–æ–∏–ª–∞ –º–∞—Ç–µ—Ä–∏–∞–ª, –±—ã—Å—Ç—Ä–æ —Ä–µ—à–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏.</td>
                                        <td>–ó–∞–¥–∞—á–∏ ‚Ññ15-20 –∏–∑ —Å–±–æ—Ä–Ω–∏–∫–∞ –û–ì–≠</td>
                                    </tr>
                                    <tr>
                                        <td>03.02.2025</td>
                                        <td>–§—É–Ω–∫—Ü–∏–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∏</td>
                                        <td>–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ–º–µ</td>
                                        <td class="score-cell">72</td>
                                        <td>–ë–∞–∑–æ–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Å—Ç—Ä–æ–∏—Ç —Ö–æ—Ä–æ—à–æ, –Ω–æ –Ω—É–∂–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ —Å –ø–∞—Ä–∞–±–æ–ª–∞–º–∏.</td>
                                        <td>–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- –¢–∞–±–ª–∏—Ü–∞ –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π -->
                    <div class="homework-table-section">
                        <h3>–ò—Å—Ç–æ—Ä–∏—è –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π</h3>
                        <div class="table-wrapper">
                            <table class="lessons-table homework-table">
                                <thead id="parentHomeworkTableHeader">
                                    <tr>
                                        <th>–î–∞—Ç–∞ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è</th>
                                        <th>–ü–µ—Ä–≤–∏—á–Ω—ã–µ –±–∞–ª–ª—ã –∑–∞ –ø—Ä–æ–±–Ω–∏–∫</th>
                                        <th>–í—Ç–æ—Ä–∏—á–Ω—ã–µ –±–∞–ª–ª—ã –∑–∞ –ø—Ä–æ–±–Ω–∏–∫</th>
                                        <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π</th>
                                        <th>–û—Ü–µ–Ω–∫–∞ –∑–∞ –ø—Ä–æ–±–Ω–∏–∫</th>
                                    </tr>
                                </thead>
                                <tbody id="parentHomeworkTableBody">
                                    <tr>
                                        <td>06.02.2025</td>
                                        <td class="score-cell">45</td>
                                        <td class="score-cell">89</td>
                                        <td>18/20</td>
                                        <td class="score-cell">5</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
    <script>
        // ===== –î–ê–ù–ù–´–ï –î–õ–Ø –†–ê–ó–ù–´–• –î–ï–¢–ï–ô (–ú–ê–ö–ï–¢) =====
        const childrenData = {
            0: { // –ú–∞—Ä–∏—è
                name: '–ú–∞—Ä–∏—è',
                class: '9 –∫–ª–∞—Å—Å',
                examScores: [
                    { date: '29.01', score: 92 },
                    { date: '01.02', score: 85 },
                    { date: '03.02', score: 72 },
                    { date: '05.02', score: 85 }
                ],
                topicProgress: { fully: 65, questions: 20, needWork: 15 },
                lessons: [
                    {
                        date: '05.02.2025',
                        topic: '–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è',
                        conclusion: '–¢–µ–º–∞ —Ä–∞–∑–æ–±—Ä–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é',
                        score: 85,
                        fullConclusion: '–ú–∞—Ä–∏—è –æ—Ç–ª–∏—á–Ω–æ —É—Å–≤–æ–∏–ª–∞ –º–∞—Ç–µ—Ä–∏–∞–ª, –±—ã—Å—Ç—Ä–æ —Ä–µ—à–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏.',
                        homework: '–ó–∞–¥–∞—á–∏ ‚Ññ15-20 –∏–∑ —Å–±–æ—Ä–Ω–∏–∫–∞ –û–ì–≠'
                    },
                    {
                        date: '03.02.2025',
                        topic: '–§—É–Ω–∫—Ü–∏–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∏',
                        conclusion: '–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ–º–µ',
                        score: 72,
                        fullConclusion: '–ë–∞–∑–æ–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Å—Ç—Ä–æ–∏—Ç —Ö–æ—Ä–æ—à–æ, –Ω–æ –Ω—É–∂–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ —Å –ø–∞—Ä–∞–±–æ–ª–∞–º–∏.',
                        homework: '–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è'
                    }
                ]
            },
            1: { // –ê–ª–µ–∫—Å–∞–Ω–¥—Ä
                name: '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä',
                class: '7 –∫–ª–∞—Å—Å',
                examScores: null, // –£ 7 –∫–ª–∞—Å—Å–∞ –Ω–µ—Ç –ø—Ä–æ–±–Ω–∏–∫–æ–≤
                topicProgress: { fully: 55, questions: 30, needWork: 15 },
                lessons: [
                    {
                        date: '04.02.2025',
                        topic: '–ü—Ä–æ–ø–æ—Ä—Ü–∏–∏',
                        conclusion: '–¢–µ–º–∞ —Ä–∞–∑–æ–±—Ä–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é',
                        score: null,
                        fullConclusion: '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä —Ö–æ—Ä–æ—à–æ –ø–æ–Ω–∏–º–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø –ø—Ä–æ–ø–æ—Ä—Ü–∏–π, —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.',
                        homework: '–ó–∞–¥–∞—á–∏ –Ω–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ ‚Ññ8-12'
                    }
                ]
            },
            2: { // –ï–ª–∏–∑–∞–≤–µ—Ç–∞
                name: '–ï–ª–∏–∑–∞–≤–µ—Ç–∞',
                class: '11 –∫–ª–∞—Å—Å',
                examScores: [
                    { date: '28.01', score: 76 },
                    { date: '30.01', score: 82 },
                    { date: '02.02', score: 89 },
                    { date: '06.02', score: 91 }
                ],
                topicProgress: { fully: 70, questions: 20, needWork: 10 },
                lessons: [
                    {
                        date: '06.02.2025',
                        topic: '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è',
                        conclusion: '–¢–µ–º–∞ —Ä–∞–∑–æ–±—Ä–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é',
                        score: 91,
                        fullConclusion: '–ï–ª–∏–∑–∞–≤–µ—Ç–∞ –æ—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ —Å–ª–æ–∂–Ω—ã–º–∏ —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–º–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è–º–∏.',
                        homework: '–ó–∞–¥–∞–Ω–∏—è –∏–∑ –ï–ì–≠ ‚Ññ13'
                    }
                ]
            }
        };

        let currentChildIndex = 0;
        let hasMultipleChildren = true; // –î–ª—è –¥–µ–º–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å

        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –õ–ö–† =====
        document.addEventListener('DOMContentLoaded', function() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –¥–µ—Ç–µ–π –µ—Å–ª–∏ –∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ
            if (hasMultipleChildren) {
                document.getElementById('childrenSwitcher').style.display = 'flex';
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–≥—Ä–∞–º–º –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞
            updateChildProgress(0);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ-—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã (–∏–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏)
            setTimeout(() => {
                document.querySelector('.widget-loading').style.display = 'none';
                document.querySelector('.schedule-demo').style.display = 'block';
            }, 2000);
        });
// ===== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –ú–ï–ñ–î–£ –î–ï–¢–¨–ú–ò =====
        function switchChild(childIndex) {
            currentChildIndex = childIndex;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('.child-toggle-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.child-toggle-btn[data-child="${childIndex}"]`).classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏
            updateChildProgress(childIndex);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –±—É–¥–µ—Ç –∏–∑ –ë–î)
            updateFinancialInfo(childIndex);
        }

        // ===== –û–ë–ù–û–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–• –£–°–ü–ï–í–ê–ï–ú–û–°–¢–ò =====
        function updateChildProgress(childIndex) {
            const childData = childrenData[childIndex];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –∏ –∫–ª–∞—Å—Å
            document.getElementById('currentChildName').textContent = childData.name;
            const classInfo = document.querySelector('#progress-tab .content-section p');
            if (classInfo) {
                classInfo.textContent = childData.class;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∏–∞–≥—Ä–∞–º–º—ã
            if (childData.examScores) {
                renderParentBarChart(childData.examScores);
                document.querySelector('.bar-chart-section').style.display = 'block';
                document.querySelector('.bar-chart-section h3').textContent = 
                    childData.class.includes('9') ? '–ë–∞–ª–ª—ã –∑–∞ –ø—Ä–æ–±–Ω–∏–∫–∏ –û–ì–≠' : '–ë–∞–ª–ª—ã –∑–∞ –ø—Ä–æ–±–Ω–∏–∫–∏ –ï–ì–≠';
            } else {
                document.querySelector('.bar-chart-section').style.display = 'none';
            }
            
            renderParentPieChart(childData.topicProgress);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É —É—Ä–æ–∫–æ–≤
            updateLessonsTable(childData.lessons);
        }

        // ===== –û–¢–†–ò–°–û–í–ö–ê –°–¢–û–õ–ë–ß–ê–¢–û–ô –î–ò–ê–ì–†–ê–ú–ú–´ –î–õ–Ø –õ–ö–† =====
        function renderParentBarChart(scores) {
            const barChart = document.getElementById('parentBarChart');
            
            if (!barChart) return;
            
            barChart.innerHTML = '';
            barChart.className = 'bar-chart';
            
            const maxScore = 100;
            const chartHeight = 220;
            
            scores.forEach(scoreData => {
                const barItem = document.createElement('div');
                barItem.className = 'bar-item';
                
                const height = Math.max(20, (scoreData.score / 100) * chartHeight);
                barItem.style.height = height + 'px';
                
                const tooltip = document.createElement('div');
                tooltip.className = 'bar-tooltip';
                tooltip.textContent = `${scoreData.date}: ${scoreData.score} –±–∞–ª–ª–æ–≤`;
                
                barItem.appendChild(tooltip);
                barChart.appendChild(barItem);
            });
        }

        // ===== –û–¢–†–ò–°–û–í–ö–ê –ö–†–£–ì–û–í–û–ô –î–ò–ê–ì–†–ê–ú–ú–´ –î–õ–Ø –õ–ö–† =====
        function renderParentPieChart(progress) {
            const pieChart = document.querySelector('#parentPieChart svg');
            
            if (!pieChart) return;
            
            pieChart.innerHTML = '';
            
            const total = progress.fully + progress.questions + progress.needWork;
            const center = 100;
            const radius = 85;
            
            const colors = ['#5ED9D7', '#f472b6', '#60a5fa'];
            const values = [progress.fully, progress.questions, progress.needWork];
            
            let currentAngle = -90;
            
            // –°–æ–∑–¥–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
            const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
            
            colors.forEach((color, index) => {
                const gradient = document.createElementNS('http://www.w3.org/2000/svg', 'radialGradient');
                gradient.setAttribute('id', `parent-gradient-${index}`);
                gradient.setAttribute('cx', '30%');
                gradient.setAttribute('cy', '30%');
                
                const stop1 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
                stop1.setAttribute('offset', '0%');
                stop1.setAttribute('stop-color', lightenColor(color, 20));
                
                const stop2 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
                stop2.setAttribute('offset', '100%');
                stop2.setAttribute('stop-color', darkenColor(color, 15));
                
                gradient.appendChild(stop1);
                gradient.appendChild(stop2);
                defs.appendChild(gradient);
            });
            
            pieChart.appendChild(defs);
            
            values.forEach((value, index) => {
                if (value > 0) {
                    const percentage = value / total;
                    const angle = percentage * 360;
                    
                    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    
                    const startAngle = (currentAngle * Math.PI) / 180;
                    const endAngle = ((currentAngle + angle) * Math.PI) / 180;
                    
                    const x1 = center + radius * Math.cos(startAngle);
                    const y1 = center + radius * Math.sin(startAngle);
                    const x2 = center + radius * Math.cos(endAngle);
                    const y2 = center + radius * Math.sin(endAngle);
                    
                    const largeArc = angle > 180 ? 1 : 0;
                    
                    const pathData = [
                        `M ${center} ${center}`,
                        `L ${x1} ${y1}`,
                        `A ${radius} ${radius} 0 ${largeArc} 1 ${x2} ${y2}`,
                        'Z'
                    ].join(' ');
                    
                    path.setAttribute('d', pathData);
                    path.setAttribute('fill', `url(#parent-gradient-${index})`);
                    path.setAttribute('stroke', '#ffffff');
                    path.setAttribute('stroke-width', '2');
                    path.setAttribute('class', 'pie-segment');
                    
                    pieChart.appendChild(path);
                    
                    currentAngle += angle;
                }
            });
        }

        // ===== –û–ë–ù–û–í–õ–ï–ù–ò–ï –¢–ê–ë–õ–ò–¶–´ –£–†–û–ö–û–í =====
        function updateLessonsTable(lessons) {
            const tableBody = document.getElementById('parentLessonsTableBody');
            
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            
            lessons.forEach(lesson => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${lesson.date}</td>
                    <td>${lesson.topic}</td>
                    <td>${lesson.conclusion}</td>
                    <td class="score-cell">${lesson.score || '-'}</td>
                    <td>${lesson.fullConclusion}</td>
                    <td>${lesson.homework}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // ===== –û–ë–ù–û–í–õ–ï–ù–ò–ï –§–ò–ù–ê–ù–°–û–í–û–ô –ò–ù–§–û–†–ú–ê–¶–ò–ò =====
        function updateFinancialInfo(childIndex) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∏–∑ –ë–î
            const financialData = {
                0: { planned: 12, stock: 5, debt: 2, price: 1500, completed: 25, cancelled: 3 },
                1: { planned: 10, stock: 3, debt: 0, price: 1300, completed: 20, cancelled: 2 },
                2: { planned: 15, stock: 7, debt: 1, price: 1700, completed: 30, cancelled: 1 }
            };
            
            const data = financialData[childIndex];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö
            const cards = document.querySelectorAll('.financial-card');
            if (cards[0]) cards[0].querySelector('.financial-value').textContent = data.planned;
            if (cards[1]) cards[1].querySelector('.financial-value').textContent = data.stock;
            if (cards[2]) cards[2].querySelector('.financial-value').textContent = data.debt;
            if (cards[3]) cards[3].querySelector('.financial-value').textContent = data.price + '‚ÇΩ';
            if (cards[4]) cards[4].querySelector('.financial-value').textContent = data.completed;
            if (cards[5]) cards[5].querySelector('.financial-value').textContent = data.cancelled;
        }

        // ===== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –¶–í–ï–¢–û–í =====
        function lightenColor(color, percent) {
            const num = parseInt(color.replace("#", ""), 16);
            const amt = Math.round(2.55 * percent);
            const R = (num >> 16) + amt;
            const G = (num >> 8 & 0x00FF) + amt;
            const B = (num & 0x0000FF) + amt;
            return "#" + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
                (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
                (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1);
        }

        function darkenColor(color, percent) {
            const num = parseInt(color.replace("#", ""), 16);
            const amt = Math.round(2.55 * percent);
            const R = (num >> 16) - amt;
            const G = (num >> 8 & 0x00FF) - amt;
            const B = (num & 0x0000FF) - amt;
            return "#" + (0x1000000 + (R > 255 ? 255 : R < 0 ? 0 : R) * 0x10000 +
                (G > 255 ? 255 : G < 0 ? 0 : G) * 0x100 +
                (B > 255 ? 255 : B < 0 ? 0 : B)).toString(16).slice(1);
        }
    </script>
{% endblock %}